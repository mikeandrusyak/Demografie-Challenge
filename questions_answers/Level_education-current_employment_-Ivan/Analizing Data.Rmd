Question: How does education level vary with type of employment?

Loading the libraries 
```{r}
library(vcd)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
```

Reading the data file
```{r}
data <- read.csv("zp_merged_data.csv")
```

Extracting only the necessary data
```{r}
# I love Kuzu
selected_data <- data %>% 
  select(
    -CURROCCUPATIONISCO, 
    -HIGHESTCOMPLEDUAGGI, 
    -CURRACTIVITY_HOME, 
    -CURRACTIVITY_PART, 
    -CURRACTIVITY_FULL
  )
head(selected_data)
```
```{r}
print(unique(selected_data$IN_EDUCATION))
```

This code transforms a dataset by creating and modifying variables, making it ready for analysis
```{r}
decoded_data <- selected_data %>% 
  mutate(
    IN_EDUCATION = recode(as.factor(IN_EDUCATION),
                          "0" = "Not In Education",
                          "1" = "In Education"),
                        
      CURRACTIVITYSTATUSIII = case_when(
      CURRACTIVITYSTATUSIII == "1" ~ "Full Time",
      CURRACTIVITYSTATUSIII %in% c("2", "3", "4") ~ "Part Time",
      TRUE ~ "Unemployed"
    ),
    HIGHESTCOMPLEDU = recode(as.factor(HIGHESTCOMPLEDU),
                             "1" = "None", 
                             "2" = "Compulsory Education",
                             "3" = "Compulsory Education", 
                             "4" = "Secondary Schooling",
                             "5" = "Secondary Schooling", 
                             "6" = "Basic Vocational Education and Training", 
                             "7" = "Secondary Schooling",
                             "8" = "Secondary Schooling", 
                             "9" = "Higher Vocational and Professional Education and Training", 
                             "10" = "Higher Vocational and Professional Education and Training",
                             "11" = "Universities and Higher Education Institutions", 
                             "12" = "Universities and Higher Education Institutions",   
                             "13" = "Universities and Higher Education Institutions"),
    SEX = recode(as.factor(SEX),
                 "2" = "Female",
                 "1" = "Male")
  ) %>%
  mutate(Employment_Type = as.factor(CURRACTIVITYSTATUSIII))
    
    
    

decoded_data$AGE <- cut(selected_data$AGE,
  breaks = c(15, 22, 29, 36, 43, 50, 57, Inf), 
  right = FALSE, 
  labels = as.factor(c("15-21", "22-28", "29-35", "36-42", "43-49", "50-56", "57+"))
)
```


```{r}
head(decoded_data)
```

# Summary of missing values and levels

This code checks the dataset for missing values (⁠ NA ⁠) in each column and identifies unused levels in factor variables, ensuring the data is clean and ready for analysis.
```{r}

summary_cleaned_data <- lapply(decoded_data, function(x) {
  list(
    MissingValues = sum(is.na(x)),
    Levels = if (is.factor(x)) levels(x) else NULL
  )
})
print(summary_cleaned_data)
str(decoded_data)
```


#Filter and Clean Data 

This code filters out invalid and missing values  and drops unused factor levels.The result is stored in cleaned_data for analysis.

```{r}

clean_data <- decoded_data %>%
  mutate(across(where(is.factor), as.character)) %>%
  filter(if_all(everything(), ~ . != "-9" & . != "-10" & !is.na(.))) %>%
  mutate(across(where(is.character), as.factor))
```

```{r}
str(clean_data)
```

---------------------------------------------------------------------------------
Plots
 
 
1.The most frequent education/employment level
  
What is the most commonly completed education level and the most common employment type among different generations?

-Basic Vocational Education and Training" is the most commonly completed education level among the population.


```{r}
heatmap_data <- clean_data %>%
  count(AGE, HIGHESTCOMPLEDU)

ggplot(heatmap_data %>% 
         mutate(
           HIGHESTCOMPLEDU = factor(
             HIGHESTCOMPLEDU,
             levels = c(
               "None",
               "Compulsory Education",
               "Secondary Schooling",
               "Basic Vocational Education and Training",
               "Higher Vocational and Professional Education and Training",
               "Universities and Higher Education Institutions"
             )
           )
         ), aes(x = AGE, y = HIGHESTCOMPLEDU, fill = n)) +
  geom_tile(color = "black") + 
  scale_fill_distiller(palette = "Reds", direction = 1) +
  labs(
    title = "Age Group and Education Level",
    x = "Age Group",
    y = "Education Level",
    fill = "Frequency"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(color = "black", size = 1.5), 
    panel.grid = element_blank() 
  )
```
 
-People start to concentrate on work when they reach 30 Year Age.
-People mostly prefer to work Full-Time
```{r}
heatmap_data <- clean_data %>%
  count(AGE, Employment_Type)

ggplot(heatmap_data, aes(x = AGE, y = Employment_Type, fill = n)) +
  geom_tile(color = "black") + 
  scale_fill_distiller(palette = "Reds", direction = 1) +
  labs(
    title = "Age Group and Employment Type",
    x = "Age Group",
    y = "Employment Type",
    fill = "Frequency"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(color = "black", size = 1.5), 
    panel.grid = element_blank() 
  )
```
 
 
 
 
 2. Gender and employment
 
```{r}
clean_data <- clean_data %>%
    rename(Gender = SEX)

ggplot(clean_data, aes(x = Employment_Type, fill = Gender)) +
  geom_bar(position = "fill") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Distribution of Gender by Employment Type",
    x = "Employment Type",
    y = "Percent"
  ) + coord_flip()
```


 
3. Analyzing the people on education

  - What proportion of individuals in each age group are still in education?
  
It appears that people tend to stop pursuing education after the age of 22, shifting their focus to work. This pattern is evident in the decreasing proportion of individuals in education as the age group increases.

```{r}

clean_data %>%
  ggplot(aes(x = AGE, fill = IN_EDUCATION)) +
  geom_bar(position = "fill") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Age Group and Education Status",
    x = "Age",
    y = "Proportion",
    fill = "Education Status"
  ) + 
  coord_flip()
  
```

 - How does the highest education level affect continuing education? After which education level and at what age do people tend to stop education and focus on working?


```{r}

ggplot(clean_data %>% 
         mutate(
           HIGHESTCOMPLEDU = factor(
             HIGHESTCOMPLEDU,
             levels = c(
               "None",
               "Compulsory Education",
               "Secondary Schooling",
               "Basic Vocational Education and Training",
               "Higher Vocational and Professional Education and Training",
               "Universities and Higher Education Institutions"
             )
           )
         ),
       aes(x = HIGHESTCOMPLEDU, fill = IN_EDUCATION)) +
  geom_bar(position = "fill") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Proportion of Education Status by Highest Education Level",
    x = "Highest Education Level",
    y = "Proportion",
    fill = "Education Status"
  ) +
  coord_flip()
```

 
 
 4.Employment and Education:

What percentage of individuals in education are employed full-time, part-time, or unemployed?
- The graph largely confirms the hypothesis that a higher level of education is associated with a higher probability of having Full-time employment and a lower probability of being unemployed.

```{r}



ggplot(clean_data %>% 
         mutate(
           HIGHESTCOMPLEDU = factor(
             HIGHESTCOMPLEDU,
             levels = c(
               "None",
               "Compulsory Education",
               "Secondary Schooling",
               "Basic Vocational Education and Training",
               "Higher Vocational and Professional Education and Training",
               "Universities and Higher Education Institutions"
             )
           )
         ) ,aes(x = HIGHESTCOMPLEDU, fill = Employment_Type)) +
  geom_bar(position = "fill") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Distribution of Employment Types by Education Level",
    x = "Education Level",
    y = "Proportion"
  ) +
  coord_flip()
```




-------------------------------------------------------------------------------------------------------------
The correlation between level of Education and Employment type
-------------------------------------------------------------------------------------------------------------

The analysis highlights a strong correlation between education level and employment type. Higher education is associated with significantly better employment outcomes, particularly in securing full-time jobs and reducing the risk of unemployment. Policymakers and educators should focus on enhancing access to education and aligning training programs with workforce demands to ensure economic stability for individuals across all education levels.

As the younger generation increasingly prioritizes higher education, this trend suggests they are likely to secure more stable jobs and experience lower unemployment rates in the future. This aligns with Switzerland's substantial financial support for individuals pursuing higher education, reflecting the country's commitment to fostering a highly educated workforce and ensuring long-term economic stability.