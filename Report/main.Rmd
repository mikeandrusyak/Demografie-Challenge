---
title: "Opportunities for integration through homeownership and their correlation with education level and employment rate"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
---
 

```{r ,echo=FALSE,message=FALSE}
library(dplyr)
library(ggplot2)
library(RColorBrewer)
source("chart_functions.R")
source("decode_lists.R")
```

```{r ,echo=FALSE,message=FALSE}
zp_merged_data <- read.csv("data/zp_merged_data.csv")  # individual-level data
hh_merged_data <- read.csv("data/hh_merged_data.csv")  # household-level data
```
```{r ,echo=FALSE,message=FALSE}
# Merge datasets (household-level + individual-level)
merged_data <- hh_merged_data %>%
  left_join(zp_merged_data, by = c("HOUSEHOLDYEARLYID" = "HOUSEHOLDYEARLYID",
                                   "YEAR_QUIZ" = "YEAR_QUIZ"))
```

```{r ,echo=FALSE,message=FALSE}
merged_data <- decode(merged_data, HIGHESTCOMPLEDU, education_level)
merged_data <- decode(merged_data, IN_EDUCATION, in_edu)
merged_data <- decode(merged_data, CURRACTIVITYSTATUSIII, activity_status)
merged_data <- decode(merged_data, NATIONALITYCAT, nationality_category)
merged_data <- decode(merged_data, RESIDENTPERMIT, permit)
merged_data <- decode(merged_data, SECCITIZENSHIP, citizen)
merged_data <- decode(merged_data, TYPEOFOWNERSHIP, owner_ship)
merged_data <- decode(merged_data, NATIONALITYCONTI, nationality_conti)
```

```{r}
merged_data <- merged_data %>% 
  mutate(Employment_Type = as.factor(CURRACTIVITYSTATUSIII))
```

```{r ,echo=FALSE,message=FALSE}
merged_data$AGE_GROUP <- cut(
  merged_data$AGE,
  breaks = c(15, 25, 40, 55, Inf), 
  right = FALSE, 
  labels = c("15-25", "25-40", "40-55", "55 +")
)

```

Education, Equality, and Ownership:  
Unveiling the Hidden Truths in Switzerland 

Moving to a new country is both exciting and challenging, and Switzerland, with its high living standards and fair economic opportunities, is no exception. However, for many foreigners, the question remains: Are these opportunities truly equal for everyone? 

Education, employment, and property ownership are critical factors that shape quality of life. Yet, social differences, particularly for foreign nationals, play a significant role in accessing these opportunities. 

This article explores key questions such as: Does higher education genuinely lead to a more comfortable life? Do foreigners in Switzerland have the same chances for employment and property ownership as citizens? 

By addressing these questions, we aim to provide both a thoughtful analysis and a reflection of the shared experiences of those striving to build a better life in Switzerland. 

```{r ,echo=FALSE,message=FALSE}
education_employment_data <- merged_data %>% 
  select(AGE_GROUP, HIGHESTCOMPLEDU, Employment_Type, IN_EDUCATION)
```

```{r ,echo=FALSE,message=FALSE}
education_employment_data <- education_employment_data %>%
  filter(
    !is.na(HIGHESTCOMPLEDU),
    !is.na(AGE_GROUP),
    !is.na(IN_EDUCATION),
    !is.na(Employment_Type)
  )
```



 

```{r ,echo=FALSE,message=FALSE}
heatmap_data <- education_employment_data %>%
  mutate(HIGHESTCOMPLEDU = factor(
    HIGHESTCOMPLEDU, 
    levels = c("None", "Compulsory", "Secondary", "Basic VET", "Higher VET", "Higher Ed")
  )) %>%
  count(AGE_GROUP, HIGHESTCOMPLEDU)

ggplot(heatmap_data, aes(x = AGE_GROUP, y = HIGHESTCOMPLEDU, fill = n)) +
  geom_tile(color = "black") + 
  scale_fill_distiller(palette = "GnBu", direction = 1,
                       labels = scales::comma) +
  labs(
    title = "Age Group and Education Level",
    x = "Age Group",
    y = "Education Level",
    fill = "Frequency"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(color = "black", size = 1.5), 
    panel.grid = element_blank()
  )
```

 Let’s begin with our first question:  

Does Education Influence Employment?

From an early age, many of us are taught that higher education is the gateway to a better, more independent life. But is this assumption accurate? Can pursuing higher education truly lead to a lifestyle that allows for more time with loved ones and hobbies? 

The belief that education provides independence and better work-life balance is one reason people strive for advanced qualifications. Higher education graduates often earn more, which may allow them to work fewer hours compared to those with lower educational levels while living the same level of comfort. 

First, let’s take a closer look at the Swiss education system. According to admin.ch Switzerland's education system is highly efficient and well-structured, ensuring nearly all children complete compulsory schooling. A significant highlight is the Vocational Education and Training (VET) system, chosen by two-thirds of upper-secondary students, which not only equips them with practical skills but also delivers economic returns, as the productivity of VET students exceeds the CHF 5 billion spent annually by companies. 

```{r ,echo=FALSE,message=FALSE}
heatmap_data <- education_employment_data %>%
  count(AGE_GROUP, Employment_Type)

ggplot(heatmap_data, aes(x = AGE_GROUP, y = Employment_Type, fill = n)) +
  geom_tile(color = "black") + 
  scale_fill_distiller(
    palette = "GnBu", 
    direction = 1, 
    labels = scales::comma 
  ) +
  labs(
    title = "Age Group and Employment Type",
    x = "Age Group",
    y = "Employment Type",
    fill = "Frequency"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(color = "black", size = 1.5), 
    panel.grid = element_blank()
  )
```
  


```{r ,echo=FALSE,message=FALSE}
data_with_proportions <- education_employment_data %>%
  group_by(HIGHESTCOMPLEDU, AGE_GROUP) %>%
  mutate(Total = n()) %>%
  mutate(HIGHESTCOMPLEDU = factor(
  HIGHESTCOMPLEDU, 
  levels = c("None", "Compulsory", "Secondary", "Basic VET", "Higher VET", "Higher Ed")
  )) %>%
  group_by(HIGHESTCOMPLEDU, AGE_GROUP, IN_EDUCATION) %>%
  summarise(Count = n(), Proportion = Count / first(Total), .groups = "drop")

data_with_proportions %>%
  ggplot(aes(x = AGE_GROUP, y = Proportion, fill = IN_EDUCATION)) +
  geom_bar(stat = "identity", position = "fill") +
  geom_text(aes(label = scales::percent(Proportion, accuracy = 1)),
            position = position_fill(vjust = 0.5), size = 3) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  facet_wrap(~HIGHESTCOMPLEDU) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Age Group and Education Status",
    x = "Age",
    y = "Proportion",
    fill = "Education Status"
  ) + 
  coord_flip()
```



```{r}
data_with_proportions <- education_employment_data %>%
  group_by(AGE_GROUP, HIGHESTCOMPLEDU) %>%  
  mutate(Total = n()) %>% 
    mutate(HIGHESTCOMPLEDU = factor(
    HIGHESTCOMPLEDU, 
    levels = c("None", "Compulsory", "Secondary", "Basic VET", "Higher VET", "Higher Ed")
  )) %>%
  group_by(AGE_GROUP, HIGHESTCOMPLEDU, Employment_Type) %>% 
  summarise(Count = n(), Proportion = Count / first(Total), .groups = "drop") 

ggplot(data_with_proportions, aes(x = AGE_GROUP, y = Proportion, fill = Employment_Type)) +
  geom_bar(stat = "identity", position = "fill") +
  geom_text(aes(label = scales::percent(Proportion, accuracy = 1)), 
            position = position_fill(vjust = 0.5), size = 3) +
  facet_wrap(~HIGHESTCOMPLEDU) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Spectral") +
  labs(
    title = "Distribution of Employment Types by Education Level",
    x = "Education Level",
    y = "Proportion",
    fill = "Employment Type"
  )
```

-----------------------------------------------------------

# How does the level of education affect the type of ownership?

***Here is a brief explanation of the TYPEOFOWNERSHIP variable:***

Tenant - Individuals renting an apartment or house.
Cooperative Member - Individuals who are members of a housing cooperative.
Condominium Owner - Owners of an apartment or unit in a building.
House Owner - Owners of an entire house.
Other Situations - Includes cases where housing is provided free by a relative or employer, service apartments (e.g., caretaker's apartment), or leased by a tenant.

```{r}
complete_edu_and_ownership <- merged_data %>%
  select(HIGHESTCOMPLEDU, AGE_GROUP, TYPEOFOWNERSHIP, YEAR_QUIZ, AGE)
```

```{r}
complete_edu_and_ownership <- complete_edu_and_ownership %>%
  filter(
    !is.na(HIGHESTCOMPLEDU),
    !is.na(AGE_GROUP)
  ) %>%
  mutate(TYPEOFOWNERSHIP = case_when(
    TYPEOFOWNERSHIP %in% c("Condominium owner", "House owner") ~ "Owner",
    TYPEOFOWNERSHIP %in% c("Tenant") ~ "Renter",
    TYPEOFOWNERSHIP == "Other situation" ~ "Other situation",
    TRUE ~ NA_character_
  )) %>% 
  filter(!is.na(TYPEOFOWNERSHIP))
```

## Plots

### How is ownership type distributed across different education levels?

```{r}
proportions_data <- complete_edu_and_ownership %>%
  mutate(HIGHESTCOMPLEDU = factor(
    HIGHESTCOMPLEDU, 
    levels = c("None", "Compulsory", "Secondary", "Basic VET", "Higher VET", "Higher Ed")
  )) %>%
  count(HIGHESTCOMPLEDU, TYPEOFOWNERSHIP) %>%
  group_by(HIGHESTCOMPLEDU) %>%
  mutate(Proportion = n / sum(n)) %>% 
  arrange(desc(Proportion), .by_group = TRUE)

ggplot(proportions_data, aes(x = HIGHESTCOMPLEDU, y = Proportion, fill = TYPEOFOWNERSHIP)) +
  geom_bar(stat = "identity", position = "fill",color = "black") +
  geom_text(
    aes(label = scales::percent(Proportion, accuracy = 0.1)),
    position = position_fill(vjust = 0.5),
    size = 3
  ) +
  scale_fill_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        axis.line = element_line(size = 1)) +
  labs(
    title = "Education Level and Ownership Type",
    x = "Education Level",
    y = "Proportion"
  )+
  coord_flip() 

```

Without considering age, renting a house is the most dominant ownership type across all education groups.

### What ownership types are more common in specific age groups? 

```{r, warning=FALSE}
ggplot(complete_edu_and_ownership, aes(x = AGE_GROUP, fill = TYPEOFOWNERSHIP)) +
  geom_bar(position = "fill", color = "black") +
  geom_text(
    aes(label = scales::percent(..count../tapply(..count.., ..x.., sum)[..x..], accuracy = 0.1)),
    stat = "count",
    position = position_fill(vjust = 0.5),
    size = 3
  ) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1), 
    axis.line = element_line(size = 1.5)
  ) +
  scale_fill_brewer(palette = "Set2") + 
  labs(
    title = "Age Group and Ownership Type",
    x = "Ownership Type",
    y = "Proportion"
  ) +
  coord_flip()
```

Older individuals are more likely to own property, even without considering the education factor.

### Analyzing the age distribution across different ownership types.

```{r, warning=FALSE}

library(ggplot2)
library(dplyr)

# Özet tablosu oluşturma
summary_table <- complete_edu_and_ownership %>%
  group_by(TYPEOFOWNERSHIP) %>%
  summarise(
    mean_age = mean(AGE, na.rm = TRUE),
    median_age = median(AGE, na.rm = TRUE)
  )

# Grafik oluşturma ve mean/median değerlerini ekleme
complete_edu_and_ownership %>%
  ggplot(aes(x = TYPEOFOWNERSHIP, y = AGE, fill = TYPEOFOWNERSHIP)) +
  geom_boxplot(outlier.shape = 16, outlier.size = 2) +
  geom_text(
    data = summary_table,
    aes(
      x = TYPEOFOWNERSHIP,
      y = mean_age,
      label = paste0("Mean: ", round(mean_age, 1))
    ),
    color = "black",
    vjust = -2.5,
    size = 3
  ) +
  geom_text(
    data = summary_table,
    aes(
      x = TYPEOFOWNERSHIP,
      y = median_age,
      label = paste0("Median: ", round(median_age, 1))
    ),
    color = "black",
    vjust = 1.5,
    size = 3
  ) +
  labs(
    title = "The Relationship Between Age and Ownership Status",
    x = "",
    y = "AGE"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(color = "black", size = 1.5),
    panel.grid = element_blank()
  ) +
  scale_fill_brewer(palette = "Set3")


```

"Tenants" and "Other Situations" exhibit broader age ranges, while "Condominium Owners" and "House Owners" show more consistent distributions.

### How have the proportions of ownership types and highest education levels changed over the years?
 
```{r}
data_with_proportions <- complete_edu_and_ownership %>%
  group_by(YEAR_QUIZ) %>%  
  mutate(Total = n()) %>%  
  group_by(YEAR_QUIZ, TYPEOFOWNERSHIP) %>% 
  summarise(Count = n(), Proportion = Count / first(Total), .groups = "drop") %>%
  ungroup()

ggplot(data_with_proportions, aes(x = YEAR_QUIZ, y = Proportion, fill = TYPEOFOWNERSHIP)) +
  geom_bar(stat = "identity", position = "fill", color = "black") +
  geom_text(aes(label = scales::percent(Proportion, accuracy = 1)),
            position = position_fill(vjust = 0.5), size = 3) +
  scale_fill_brewer(palette = "Set2") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(size = 1.5)
  ) +
  labs(
    title = "Distribution of Ownership Type Over the Years",
    x = "Year",
    y = "Proportion"
  ) +
  coord_flip()
```

The age factor does not significantly affect either education or ownership type. However, it should be noted that the data spans only 11 years.

```{r}
data_with_proportions_edu <- complete_edu_and_ownership %>%
  mutate(HIGHESTCOMPLEDU = factor(
    HIGHESTCOMPLEDU, 
    levels = c("Higher Ed", "Higher VET", "Basic VET", "Secondary", "Compulsory", "None")
  )) %>%
  group_by(YEAR_QUIZ) %>%
  mutate(Total = n()) %>% 
  group_by(YEAR_QUIZ, HIGHESTCOMPLEDU) %>%
  summarise(Count = n(), Proportion = Count / first(Total), .groups = "drop")

ggplot(data_with_proportions_edu, aes(x = YEAR_QUIZ, y = Proportion, fill = HIGHESTCOMPLEDU)) +
  geom_bar(stat = "identity", position = "fill", color = "black") +
  geom_text(aes(label = scales::percent(Proportion, accuracy = 1)),
            position = position_fill(vjust = 0.5), size = 3) +
  scale_fill_brewer(palette = "Set3") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.line = element_line(size = 1.5)
  ) +
  labs(
    title = "Level of Highest Education Over the Years",
    x = "Year",
    y = "Proportion"
  ) +
  coord_flip()
```

From this chart, we can observe that people are increasingly focusing on higher education over time. As shown in the first chart, newer generations concentrate more on higher education.

### Interplay of Multiple Factors

**Does the combination of education and age groups influence ownership type ?**

**Are there distinct patterns of ownership types for individuals with different education levels across various age groups?**

**How do the distributions of ownership types vary when both age group and education level are considered simultaneously?**
 
```{r, warning=FALSE}
grouped_data <- complete_edu_and_ownership %>%
filter(AGE_GROUP != "15-25") %>% 
  mutate(HIGHESTCOMPLEDU = factor(
    HIGHESTCOMPLEDU, 
    levels = c("None", "Compulsory", "Secondary", "Basic VET", "Higher VET", "Higher Ed")
  )) %>%
  group_by(AGE_GROUP, HIGHESTCOMPLEDU, TYPEOFOWNERSHIP) %>%
  summarise(Count = n(), .groups = "drop_last") %>% 
  mutate(Proportion = Count / sum(Count))

ggplot(grouped_data, aes(x = HIGHESTCOMPLEDU, y = Proportion, fill = TYPEOFOWNERSHIP)) +
  geom_bar(stat = "identity", color = "black") +
  geom_text(
    aes(label = scales::percent(Proportion, accuracy = 0.1)), 
    position = position_stack(vjust = 0.5), 
    size = 2.3
  ) +
  facet_wrap(~ AGE_GROUP, scales = "free") +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "Ownership Types by Age Group and Education Level",
    x = "Age Group",
    y = "Proportion"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

This trend is expected, as younger individuals are less likely to own property and more likely to rent or have undefined ownership types.

The proportion of Property Owners also increases in older age groups, particularly for mid-to-high education levels.

Higher education levels are associated with an earlier and more significant shift from Tenant to property owner.

"Tenant" remains dominant even in older age groups.

Ownership types transition earlier and more significantly for individuals with higher education levels across all age groups.

## Answer to Question

**The relationship between education, generational trends, and home ownership reveals significant patterns in societal development. This report combines insights on higher education, generational behaviors, and future projections to provide a cohesive view of how these factors interact.**

- **The Impact of Education on Home Ownership:**
Education level plays a critical role in determining the likelihood of home ownership. Individuals with higher education levels are significantly more likely to own a house compared to those with lower education levels. This trend becomes more pronounced as people age, highlighting the long-term benefits of education in achieving financial stability and home ownership. Among individuals aged 60 and older, those with higher education are more likely to own a house rather than rent, whereas this pattern is less evident among individuals with lower education levels.

- **Generational Shifts in Education and Ownership:**
Generational differences also influence these patterns. Older generations were more inclined to pursue vocational education, reflecting the economic and societal priorities of their time. In contrast, younger generations are increasingly focusing on higher education, prioritizing advanced qualifications over vocational training. This shift suggests a growing emphasis on education as a pathway to financial success and property ownership.

- **Future Implications:**
If current trends continue, the younger generation’s focus on higher education could lead to higher home ownership rates in the next 20 years. This projection assumes that the patterns of ownership remain stable, as they have over the past 11 years. However, societal changes in housing markets, economic conditions, or preferences for renting versus owning could alter this trajectory.



- **Conclusion:**
The relationship between education, generational trends, and house ownership is clear: higher education correlates with increased home ownership, particularly among older individuals. Generational shifts toward higher education suggest the potential for increased home ownership in the future, provided current patterns persist. These findings highlight the evolving role of education in shaping financial stability and housing outcomes across generations.

- **Understanding the interplay between education, generational trends, and housing patterns provides valuable insights for policymakers, educators, and society at large. Supporting education and addressing housing market challenges can pave the way for a more equitable and stable future.**

# What are the ownership types for different nationalities?

```{r}
home_owner_data <- merged_data %>% select(SECCITIZENSHIP, TYPEOFOWNERSHIP,
    SIZEOFPRIVATEHOUSEHOLD, NATIONALITYCAT, NATIONALITYCONTI
  )
```
**Decoding Data**

```{r}
home_owner_data <- home_owner_data %>%
  filter(
    !is.na(NATIONALITYCAT),
    !is.na(SIZEOFPRIVATEHOUSEHOLD),
    !is.na(TYPEOFOWNERSHIP)
  )
```

```{r}
# Define homeownership (Owner vs. Renter)
home_owner_data <- home_owner_data %>%
  mutate(HOMEOWNERSHIP = case_when(
    TYPEOFOWNERSHIP %in% c("Condominium owner", "House owner") ~ "Owner",
    TYPEOFOWNERSHIP %in% c("Tenant") ~ "Renter",
    TYPEOFOWNERSHIP == "Other situation" ~ "Other situation",
    TRUE ~ NA_character_))
```


```{r}
home_owner_data <- home_owner_data %>%
    filter(!is.na(HOMEOWNERSHIP))
```
**Group household size**
```{r}
home_owner_data <- home_owner_data %>%
  mutate(
    SIZEOFPRIVATEHOUSEHOLD_GROUP = case_when(
      SIZEOFPRIVATEHOUSEHOLD == 1 ~ "1 member",
      SIZEOFPRIVATEHOUSEHOLD >= 2 & SIZEOFPRIVATEHOUSEHOLD <= 3 ~ "2-3 members",
      SIZEOFPRIVATEHOUSEHOLD >= 4 ~ "4+ members",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(SIZEOFPRIVATEHOUSEHOLD_GROUP))
```
## Plots

### Do local Swiss people tend to own a house more than foreigners?
```{r, message=FALSE}
plot1 <- create_proportional_plot(
  data = home_owner_data,
  group_var = "NATIONALITYCAT",
  fill_var = "HOMEOWNERSHIP",
  y_var = "proportion",
  title = "Proportion of Homeownership by Nationality",
  x_label = "Nationality",
  y_label = "Proportion"
)
print(plot1)
```

**From this chart, we can understand that local Swiss people tend to have a significantly higher rate of homeownership compared to foreigners. Specifically, Swiss individuals are more likely to own a house or a condominium/apartment (50.3% ownership), while foreigners overwhelmingly tend to rent (77.6%). This indicates a clear difference in housing patterns between Swiss nationals and foreigners.**

### What is the distribution of homeownership types by continent of nationality (excluding Switzerland, stateless individuals)?
```{r, message=FALSE}
# 8.2 Example: Proportions by Continent of Nationality and Ownership
plot2 <- create_proportional_plot(
  data = home_owner_data %>%
    filter(
      !(NATIONALITYCONTI %in% c("Switzerland", NA, "Stateless")) 
    ),
  group_var = "NATIONALITYCONTI",
  fill_var = "HOMEOWNERSHIP",
  y_var = "proportion",
  title = "Homeownership by Continent",
  x_label = "Continent of Nationality",
  y_label = "Proportion"
)
print(plot2)
```

**The chart highlights clear differences in home ownership patterns by continent. Individuals from EFTA countries are more likely to own homes compared to those from Africa, Asia, or Oceania, where tenancy is overwhelmingly common.**

### What is the proportion of different ownership statuses for people who had or did not have more than one passport?

```{r, message=FALSE}
# 8.3 Plot: Proportion of Homeownership by Citizenship
home_owner_data <- home_owner_data %>% 
  na.omit()

plot1 <- create_proportional_plot(
  data = home_owner_data,
  group_var = "SECCITIZENSHIP",
  fill_var = "HOMEOWNERSHIP",
  y_var = "proportion",
  title = "Types of Ownership Among People with Multiple Passports",
  x_label = "Had Multiple Passport",
  y_label = "Proportion"
)
print(plot1)
```

**From this chart, we can see that people with more than one passport are more likely to own property rather than rent.**


### How does homeownership differ by nationality  and household size?

```{r, warning=FALSE}
# 8.4 Example of summarizing by household size
plot3 <- create_proportional_plot(
  data = home_owner_data, 
  group_var = "NATIONALITYCAT",
  fill_var = "HOMEOWNERSHIP",
  y_var = "proportion", 
  title = "Homeownership by Nationality and Household Size",
  x_label = "Nationality",
  y_label = "Proportion",
  facet_var = "SIZEOFPRIVATEHOUSEHOLD_GROUP"
)
print(plot3)
```

**People with larger families tend to own a house more often, both among locals and foreigners.**

## Answer to question

- Swiss nationals exhibit a significantly higher rate of home ownership compared to foreigners. This stark difference underscores the barriers that foreigners may face in entering the housing market, including legal, financial, and cultural factors.

- Foreign residents from EFTA countries demonstrate a significantly higher likelihood of owning homes. This trend may be attributed to similar economic conditions, cultural affinities, or easier access to financing within this group.

- In contrast, home ownership is much less common among individuals from Africa, Asia, or Oceania. This suggests potential economic or systemic challenges, such as lower income levels, limited access to credit, or administrative barriers that may disproportionately affect these groups.

- Household size significantly correlates with home ownership. Larger families, whether Swiss or foreign, are more likely to own homes, likely driven by the need for stability and larger living spaces. This trend suggests that housing policies should consider family size as a critical factor in housing assistance programs.

**Recommendations**

- Policy Support for Foreign Residents: Implement targeted housing policies to facilitate foreign residents' access to home ownership, addressing financial and legal barriers.

- Encourage home ownership Among Larger Families: Provide incentives or assistance to larger families, who demonstrate a greater propensity to own homes.

# How Does Nationality Impact Workload?

**Selecting Variables for Chart Building**
```{r}
work_loading_data <- merged_data %>% select(RENTNET,NATIONALITYCAT,TIMEWORKEDPERWEEKSUM, RESIDENTPERMIT)
```

**Filtering Extreme High RENTNET Values and NA**
```{r}
work_loading_data <- work_loading_data %>% filter((RENTNET < 5000 | RENTNET == -8) &
                                            !is.na(NATIONALITYCAT) &
                                            !is.na(RESIDENTPERMIT) &
                                            TIMEWORKEDPERWEEKSUM >= 0)
```
## Plots

### Nationality Distribution

**What is the distribution of the population by nationality?**

```{r}
distribution_categorical(work_loading_data, NATIONALITYCAT, "Nationality")
```

**The chart shows Swiss residents outnumber foreign nationals, but the significant foreign population cannot be ignored.**

---

### Analysis of Working Hours

**General overview work time between Swiss and foreign people**

```{r, warning=FALSE}
summary_stats <- work_loading_data %>%
  group_by(NATIONALITYCAT) %>%
  summarise(
    mean_hours = mean(TIMEWORKEDPERWEEKSUM, na.rm = TRUE),
    median_hours = median(TIMEWORKEDPERWEEKSUM, na.rm = TRUE),
    sd_hours = sd(TIMEWORKEDPERWEEKSUM, na.rm = TRUE),
    min_hours = min(TIMEWORKEDPERWEEKSUM, na.rm = TRUE),
    max_hours = max(TIMEWORKEDPERWEEKSUM, na.rm = TRUE),
    Q1 = quantile(TIMEWORKEDPERWEEKSUM, probs = 0.25, na.rm = TRUE),
    Q3 = quantile(TIMEWORKEDPERWEEKSUM, probs = 0.75, na.rm = TRUE),
    count = n()
  )

work_loading_data %>%
  filter(!is.na(TIMEWORKEDPERWEEKSUM) & !is.na(NATIONALITYCAT)) %>% 
  group_by(NATIONALITYCAT) %>% 
  ggplot(aes(x = NATIONALITYCAT, y = TIMEWORKEDPERWEEKSUM, fill = NATIONALITYCAT)) +
  geom_boxplot() +
  scale_fill_brewer(palette = "Spectral")+
  stat_summary(
    fun = median,
    geom = "text",  
    aes(label = round(..y.., 1)),  
    vjust = 0.5,
    hjust = 6.5,
    color = "black",  
    size = 4
  ) +
  labs(
    title = "Comparison of Working Hours by Nationality",
    x = "Nationality",
    y = "Weekly Working Hours"
  ) +
  theme_minimal()

print(summary_stats)
```

**1. Median Weekly Working Hours**
- **Migrants (Foreign):** Median weekly working time is 41 hours.  
- **Swiss Residents:** Median weekly working time is 40 hours.  
- **Implication:** This small difference aligns with the hypothesis that migrants might work slightly more on average to meet economic demands.

**2. Mean Weekly Working Hours**
- **Migrants (Foreign):** Average working hours is 37.85.  
- **Swiss Residents:** Average working hours is 35.61.  
- **Implication:**  This supports the idea that migrants tend to work longer hours overall, potentially reflecting the economic disparity between the groups.

**3. Spread and Variability**
- **Standard Deviation:**  
  - Migrants: 10.76, indicating more consistent working schedules.  
  - Swiss Residents: 12.63, showing greater variability in working hours.  
- **First Quarterly (Q1):**  
  - Migrants: 38 hours, reflecting a larger proportion working full-time or near full-time hours.  
  - Swiss Residents: 29 hours, suggesting more part-time or flexible schedules among locals.



### Rent Analysis from a Financial Perspective

**What is the difference in renting prices between foreigners and locals?** 

```{r}
work_loading_data %>%
  distribution_numeric(RENTNET, "Rent Price")
```

- Both groups have similar rent peaks (~1,500 CHF).  
- The rent distribution for foreign nationals is more concentrated in the lower rent range.
- The graph shows a significant increase in density at value 0 for both groups (foreigners and Swiss). This may indicate a large number of listings with zero rent, which may indicate that people have free accommodation or data is missing

```{r}
rent_analysis <- work_loading_data %>%
  filter(!is.na(NATIONALITYCAT)) %>%
  mutate(
    pays_rent = case_when(
      RENTNET > 0 ~ "Pays Rent",
      RENTNET < 1 | is.na(RENTNET) ~ "Does Not Pay Rent"
    )
  ) %>%
  group_by(NATIONALITYCAT, pays_rent) %>%
  summarise(count = n(), .groups = "drop") %>% 
  group_by(NATIONALITYCAT) %>% 
  mutate(percentage = round(count / sum(count) * 100,2)) %>%
  ungroup()

ggplot(rent_analysis, aes(x = pays_rent, y = percentage, fill = NATIONALITYCAT)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(
    aes(label = round(percentage, 2)),
    position = position_dodge(width = 0.9),
    vjust = -0.5,                    
    size = 3
  ) +
  scale_fill_brewer(palette = "Spectral")+
  labs(title = "Distribution of rent payment by nationality categories",
       x = "Category of nationality",
       y = "Number",
       fill = "Rent payment status") +
  theme_minimal()

print(rent_analysis)
```

- Swiss residents are more likely not to pay rent, which might indicate higher rates of home ownership or alternative living arrangements among locals.

### Analysis Work Time by Permit

```{r}
distribution_categorical(work_loading_data, RESIDENTPERMIT, "Permit")
```

**Most foreign nationals primarily hold Permit C (long-term residency), followed by Permit B (short-term residency). Other permit types make up only a small portion of the data set.**

```{r}
mean_by_permit <- work_loading_data %>% filter(TIMEWORKEDPERWEEKSUM>0) %>% 
  select(RESIDENTPERMIT, TIMEWORKEDPERWEEKSUM) %>% 
  group_by(RESIDENTPERMIT) %>% 
  summarise(mean_time = round(mean(TIMEWORKEDPERWEEKSUM, na.rm = TRUE, trim = 0.1), 2), .groups = "drop") %>% 
  filter(!is.na(RESIDENTPERMIT)) %>% 
  arrange(desc(mean_time))

ggplot(mean_by_permit, aes(x = reorder(RESIDENTPERMIT, -mean_time), y = mean_time, fill = RESIDENTPERMIT)) +
  geom_bar(stat = "identity") +
  geom_text(
    aes(label = round(mean_time, 1)),  
    vjust = -0.5,                   
    size = 3
  ) +
  scale_fill_brewer(palette = "Spectral")+
  labs(
    title = "Mean work time per week by permit",
    x = "Permit type",
    y = "Mean work time per week"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = "none")

print(mean_by_permit)
```

**Interpretation:**

- Since Permit B and C holders represent the majority of foreign nationals, we compare them to local residents.
- The average weekly working hours for Permit B holders are around 39.8 hours, which is roughly 3 hours more than Swiss residents.
- Permit C holders average around 39 hours per week, about 2.2 hours more than Swiss residents.

Permit B employees often have shorter or fixed-term contracts and must frequently apply for renewals, indicating a motivation to maintain stable employment. Permit C holders, on the other hand, may aim to obtain Swiss citizenship in the future, motivating them to work consistently and demonstrate their value to the country, especially given the complex interview and verification process for naturalization.

## Answer to Question

In general, foreigners in Switzerland are less likely to experience this level of flexibility. Many foreign workers are tied to industries and roles that demand fixed schedules, such as construction, hospitality, or manufacturing. These sectors often have less room for negotiation, and foreigners may find themselves working longer or more rigid hours to meet financial  obligations.

# Summary 

The analysis examines the relationship between education, generational trends, and home ownership in Switzerland, uncovering significant insights into societal and economic patterns. Higher education is a key determinant of home ownership, with individuals holding advanced qualifications significantly more likely to own property, particularly as they age. In contrast, vocational training, while valuable, shows a weaker association with property ownership. Generational shifts reveal that younger individuals prioritize higher education over vocational training, aligning with modern economic demands
Foreign nationals face notable disparities compared to Swiss residents, with home ownership rates significantly lower (22.4% vs. 50.3%). Migrants from EFTA countries are more likely to own property than those from Africa, Asia, or Oceania, highlighting economic and systemic barriers for certain groups. Furthermore, foreign nationals often work longer hours, predominantly in full-time roles, reflecting financial pressures and less flexibility in employment compared to Swiss residents. Household size also plays a crucial role, as larger families tend to prioritize stability through home ownership.

Looking ahead, the younger generation’s focus on higher education is likely to result in higher home ownership rates in the coming decades, provided current patterns persist. Policymakers are encouraged to address barriers faced by foreign nationals, support larger families through targeted housing policies, and facilitate greater access to higher education. These measures will help create a more equitable and stable future, ensuring that education and employment opportunities translate into tangible benefits, including property ownership, for all residents of Switzerland.








